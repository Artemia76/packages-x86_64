# Depends on: freetype efibootmgr efivar
description="The GRUB package contains the GRand Unified Bootloader, EFI version"
url="http://www.gnu.org/software/grub/"
packager="tnut at nutyx dot org"

name=grub-efi
version=2.02~beta3
release=1
run=(efivar)

source=(http://alpha.gnu.org/gnu/grub/grub-$version.tar.xz)

PKGMK_GROUPS=(man locale)

build() {
 cd grub-$version
 ./configure --prefix=/usr --sysconfdir=/etc \
 --sbindir=/sbin --disable-grub-emu-usb  \
 --disable-efiemu --enable-grub-mkfont \
 --with-platform=efi --target=x86_64 \
 --program-prefix="" --program-suffix="-efi" \
 --with-bootdir="/boot" \
 --with-grubdir="grub-efi" --disable-werror

 make

 make DESTDIR=$PKG install

 rm -rf $PKG/usr/share/info/dir
 mv $PKG/etc/bash_completion.d/grub{,-efi}
 mv $PKG/etc/grub.d/README{,-efi}
 mv $PKG/usr/share/grub/grub{,-efi}-mkconfig_lib
}
