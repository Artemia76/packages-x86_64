description="JS is Mozilla's JavaScript engine written in C."
url="https://people.mozilla.org"

packager="tnut <tnut@nutyx.org>"

makedepends=(autoconf2-13 icu libffi nspr python2 zip)

name=js68
version=68.9.0

source=(https://archive.mozilla.org/pub/firefox/releases/68.9.0esr/source/firefox-68.9.0esr.source.tar.xz)

build() {

  cd firefox-$version

  sed '21,+4d' -i js/moz.configure

  mkdir mozjs-build
  cd    mozjs-build

  ../js/src/configure --prefix=/usr       \
              --with-intl-api     \
              --with-system-zlib  \
              --with-system-nspr  \
              --with-system-icu   \
              --disable-jemalloc  \
              --enable-readline

  make

  make DESTDIR=$PKG install

  # conflict with js60
  rm $PKG/usr/lib/libjs_static.ajs
}
