description="Tweak tool for MATE (fork of MintDesktop)"
url="https://github.com/ubuntu-mate/mate-tweak"

packager="Rems <remy@nutyx.org>"
maintainer="Dania, Tnut"

name=mate-tweak
version=20.10.0
_umsver=19.10.2

set=(mate)

makedepends=(tilda gtk3 libnotify mate-applets python-configobj python-gobject python-distutils-extra mate-menus mate-netbook)
run=(python-psutil python-setproctitle python-distro)

PKGMK_KEEP_SOURCES=no

source=(https://github.com/ubuntu-mate/$name/archive/$version.tar.gz
        https://github.com/ubuntu-mate/ubuntu-mate-settings/archive/$_umsver.tar.gz)

build() {
  cd $name-$version
  
  sed -i 's|/usr/lib/mate-applets/topmenu-mate-panel-applet|/usr/lib/topmenu-gtk/topmenu-mate-panel-applet|' mate-tweak

  python3 setup.py build
  python3 setup.py install --root=$PKG --optimize=1 --skip-build

  cp -r ../ubuntu-mate-settings-$_umsver/usr/share/mate-panel $PKG/usr/share
}

uptodate() {
feed=https://github.com/mate-desktop/$name/releases.atom
exec="lynx -read_timeout=20 -dump -listonly -nonumbers $feed"
$exec $feed | grep release | grep title | head -1 | \
sed -e "s@ @@g" -e "s@<title>$name@@" -e "s@release</title>@@"
}
