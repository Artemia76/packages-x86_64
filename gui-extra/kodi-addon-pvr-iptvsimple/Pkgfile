# Depends on: kodi-platform

description="IPTV Simple PVR client addon for Kodi"
url="https://github.com/kodi-pvr/pvr.iptvsimple"
contributors=""
packager="rems <rems@nutyx.org>"

name=kodi-addon-pvr-iptvsimple
version=2.4.14
kodiver=17.6
koditarget=Krypton
PKGMK_KEEP_SOURCES="no"

source=(https://github.com/kodi-pvr/pvr.iptvsimple/archive/$version-$koditarget.tar.gz
        https://github.com/xbmc/xbmc/archive/$kodiver-$koditarget.tar.gz)

build() {

mkdir -p "pvr.iptvsimple-$version-$koditarget/build"
cd pvr.iptvsimple-$version-$koditarget/build

cmake -DCMAKE_INSTALL_PREFIX=/usr \
      -DCMAKE_INSTALL_LIBDIR=/usr/lib/kodi \
      -DCMAKE_BUILD_TYPE=Release \
      -DBUILD_SHARED_LIBS=1 \
      -DADDONS_TO_BUILD=pvr.iptvsimple \
      -DADDONS_SRC_PREFIX=../.. \
      ../../xbmc-$kodiver-$koditarget/project/cmake/addons

  make
install -vdm755 "$PKG/usr/lib/"
install -vdm755 "$PKG/usr/share/"
mv -v build/depends/lib/kodi/ "$PKG/usr/lib/kodi/"
mv -v build/depends/share/kodi/ "$PKG/usr/share/kodi/"
}
