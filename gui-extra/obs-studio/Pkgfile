# Depends on: ffmpeg jansson xorg-libxinerama libxkbcommon qtx11extras curl jack gtk-update-icon-cache cmake xorg-libxcomposite x264 vlc swig python luajit fdk-aac

description="Free, open source software for live streaming and recording"
url="https://obsproject.com"
packager="tnut <tnut@nutyx.org>"
contributors="Greg"

run=(gtk-update-icon-cache)

name=obs-studio
version=22.0.2
release=2

PKGMK_KEEP_SOURCES="no"

source=(https://github.com/jp9000/obs-studio/archive/$version.tar.gz
        https://github.com/obsproject/obs-studio/commit/cf73fa6da19f798ce04907781d6dc00484820b77.patch)

build() {
cd $name-$version
patch -Np1 -i ../cf73fa6da19f798ce04907781d6dc00484820b77.patch
sed -i '15i #include <QAction>' UI/frontend-plugins/frontend-tools/scripts.cpp
mkdir build
cd    build
cmake -DCMAKE_INSTALL_PREFIX="/usr" \
-DOBS_VERSION_OVERRIDE="$version-$release" ..
make
make DESTDIR=$PKG install
}
