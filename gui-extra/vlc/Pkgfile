# Depends on: qtbase qtsvg qtx11extras x264 flac libmad glib librsvg alsa-lib xorg-libxinerama xorg-libxpm libvpx libcdio vcdimager live libdvdcss libdvdread libdvdnav libogg libtheora lame faac libvorbis ffmpeg faad2 liba52 libmpcdec fribidi lua libdv speex samba libupnp nfs-utils libshout libnotify speex sdl-image libcaca chromaprint libmtp taglib libsecret libva libvdpau

description="Media player, streamer, and encoder. It can play from many inputs"
url="http://www.slackware.com/~alien/slackbuilds/vlc/"
packager="tnut <tnut@nutyx.org>"
contributors="Pierre B"

name=vlc
version=3.0.0

source=(https://download.videolan.org/$name/$version/$name-$version.tar.xz
	lua53_compat.patch
	update-vlc-plugin-cache.hook)
build() {

cd $name-$version

patch -p1 -i ../lua53_compat.patch

./bootstrap

BUILDCC="/usr/bin/gcc -std=c99" ./configure --prefix=/usr \
            --disable-rpath \
            --sysconfdir=/etc \
            --disable-ncurses \
            --enable-aa \
            --enable-upnp \
            --enable-opus \
            --enable-bluray

make

make DESTDIR=$PKG docdir=/usr/share/doc/$name-$version-release install

for res in 16 32 48 128; do
    install -D -m644 "$SRC/vlc-$version/share/icons/${res}x${res}/vlc.png" \
    "$PKG/usr/share/icons/hicolor/${res}x${res}/apps/vlc.png"
done
install -Dm 644 $SRC/update-vlc-plugin-cache.hook -t $PKG/usr/share/libalpm/hooks
}
