description="Programs that work with contacts, tasks, and calendar information"
url="http://www.gnome.org/"

packager="spiky <spiky@nutyx.org>"
contributors="Fanch, Tnut, Jayce, Remy, tnut"

makedepends=(vim db libcanberra gnome-online-accounts gnome-common gperf icu
             libgdata libical libsecret libsoup nss libgweather vala 
             gobject-introspection kerberos gtk3 openldap)

name=evolution-data-server
version=3.40.0

source=(https://download.gnome.org/sources/$name/${version%.*}/$name-$version.tar.xz
        http://192.168.0.200/nutyx/patches/3.38-PrintableOptions.cmake-Correct-variable-name-compari.patch)

build() {
cd $name-$version
patch -Np1 -i ../3.38-PrintableOptions.cmake-Correct-variable-name-compari.patch
mkdir build
cd    build
cmake -DCMAKE_INSTALL_PREFIX=/usr   \
      -DENABLE_UOA=OFF              \
      -DENABLE_VALA_BINDINGS=ON     \
      -DENABLE_INSTALLED_TESTS=ON   \
      -DENABLE_GOOGLE=ON            \
      -DENABLE_GOOGLE_AUTH=OFF      \
      -DWITH_OPENLDAP=OFF           \
      -DWITH_KRB5=OFF               \
      -DENABLE_INTROSPECTION=ON     \
      -DENABLE_GTK_DOC=OFF          \
      -DWITH_SYSTEMDUSERUNITDIR=no  \
      ..
make
make DESTDIR=$PKG install
}
