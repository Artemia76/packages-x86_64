# Depends on: qt-base qt-webchannel qt-location xorg-libxcomposite xorg-libxrandr pciutils libvpx libevent snappy nss protobuf libxslt ffmpeg git gperf qjson icu zlib libwebp xorg-libxscrnsaver

description="Provides support for web applications using the Chromium browser project"
url="http://qt-project.org/"
packager="tnut <tnut@nutyx.org>"
contributors="Pierre B"

name=qt-webengine
version=5.9.1
release=1
alias=(qtwebengine)
_name="${name/-/}-opensource-src"

source=(https://download.qt.io/official_releases/qt/5.9/$version/submodules/${_name}-${version}.tar.xz)

build() {
  cd ${_name}-${version}
  mkdir build
  cd build 
  qmake WEBENGINE_CONFIG+="use_proprietary_codecs" ../ 
  make
  make INSTALL_ROOT=$PKG install

# Drop QMAKE_PRL_BUILD_DIR because reference the build dir
  find "$PKG/usr/lib" -type f -name '*.prl' \
       -exec sed -i -e '/^QMAKE_PRL_BUILD_DIR/d' {} \;
}
