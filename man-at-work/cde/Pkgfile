description='The Common desktop Environment (CDE)'
url='https://sourceforge.net/projects/cdesktopenv/'

packager="tnut <tnut@nutyx.org>"

makedepends=(git m4 tcl flex bison ksh ncompress printproto rpcsvc-proto libjpeg-turbo libtirpc
             libutempter openmotif pam xorg-libice xorg-libsm xorg-libx11 xorg-libxau xorg-xrdb
             xorg-libxdmcp xorg-libxext xorg-bdftopcf xorg-mkfontscale xorg-libxaw
             xorg-libxinerama xorg-libxmu xorg-libxpm xorg-libxscrnsaver xorg-libxt)

run=(font-adobe-100dpi font-adobe-utopia-100dpi font-bh-100dpi font-bitstream-100dpi
     font-bh-lucidatypewriter-100dpi)

name=cde
version=git-75c377

prepare() {
  git clone http://git.code.sf.net/p/cdesktopenv/code
  cd code/$name
  ./autogen.sh
  sed -i "s@^ac_default_prefix=/usr/dt@ac_default_prefix=/opt/dt@" configure
}
build() {
  cd code/$name

  sed -i "s@MOTIFHOME=/usr/dt@MOTIFHOME=/opt/dt@" lib/tt/demo/ttsample/Makefile
  sed -i "s@MOTIFHOME=/usr/dt@MOTIFHOME=/opt/dt@" lib/tt/demo/edit_demo/Makefile
  sed -i "s@Exec=/usr/dt/bin/Xsession@Exec=/opt/dt/bin/Xsession@" contrib/desktopentry/cde.desktop

  ./configure
  
  make -j1
  make -j1 DESTDIR=$PKG install

mkdir -p $PKG/usr/share/xsessions
cp contrib/desktopentry/cde.desktop \
$PKG/usr/share/xsessions

}
