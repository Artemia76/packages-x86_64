echo "Ce script vérifie tout ce qu'il peut pour que vous puissiez commencez"
echo ""
echo "Pressez Entrer pour continuer ou ctrl+c pour interrompre"
echo ""
read a
# Checking the current directory
if [ "`pwd`" != "/home/lfs/saravane" ]; then
	echo "Le script doit être lancé depuis le dossier /home/lfs/saravane"
	exit 1
fi
# Checking the variables
if [ ! -f ~/.bash_profile ]; then
	echo ".bash_profile n'existe pas"
	exit 1
fi
echo ".bash_profile present: OK"
if [ -z "${LFS}" ]; then
	echo "LFS n'existe pas"
	exit 1
fi
echo "LFS: $LFS OK"
if [ -z "${LFS_TGT}" ]; then
   echo "LFS_TGT n'existe pas"
   exit 1
fi
echo "LFS_TGT: $LFS_TGT OK"

# Checking the user

if [ "`whoami`" != "lfs" ]; then 
	echo "Vous n'êtes pas l'utilisateur lfs"
	exit 1
else
	echo "utilisateur lfs: OK"
fi
# Checkings Directories

if [ ! -d $LFS ]; then
	echo "$LFS n'existe pas"
	exit 1
else
	echo "Folder $LFS: OK"
fi
if [ ! -O $LFS ]; then
	echo "$LFS n'appartient pas à lfs"
	exit 1
fi
if [ ! -d $LFS/sources ]; then
   echo "$LFS/sources n'existe pas"
   exit 1
else
	echo "Folder $LFS/sources: OK"
fi
if [ ! -O $LFS/sources ]; then
	echo "$LFS/sources n'appartient pas à lfs"
	exit 1
fi

if [ ! -L /sources ];then
        echo "Faites en root:"
        echo "ln -sv $LFS/sources /sources"
        exit 1
fi
if [ ! -d $LFS/tools ]; then
	echo "$LFS/tools n'existe pas"
	exit 1
else
	echo "Folder $LFS/tools: OK"
fi
if [ ! -O $LFS/tools ];then
	echo "$LFS/tools n'appartient pas à lfs"
	exit 1
fi
if [ ! -d /home/lfs/logs ]; then
   echo "Dossier /home/lfs/logs n'existe pas"
   mkdir -p $HOME/logs
fi
echo "Folder /home/lfs/logs: OK"

# Checking Links

if [ ! -L /tools ]; then
	echo "Lien /tools n'existe pas"
	exit 1
else
	echo "Link /tools: OK"
fi

if [ ! -L /home/lfs/bin ]; then
	echo "Lien /home/lfs/bin n'existe pas"
	ln -sv $HOME/saravane/scripts $HOME/bin
fi
echo "link /home/lfs/bin: OK" 

if [ ! -L /home/lfs/config ];then
   echo "Lien /home/lfs/config n'existe pas"
   ln -sv $HOME/saravane/scripts $HOME/config
fi
echo "link /home/lfs/config: OK"

echo "1baa72369f511cfdd1e145a8f04234dc  aaabasicfs-20150424.tar.xz
9a1ddb0e053474d9d1105cfe39b0c48d  automake-1.15.tar.xz
a27b3ee9be83bd3ba448c0ff52b28447  bash-4.3.30.tar.gz
d9f3303f802a5b6b0bb73a335ab89d66  binutils-2.25.tar.bz2
c342201de104cc9ce0a21e0ad10d4021  bison-3.0.4.tar.xz
5bda2cdb1af51a80aecce58d6e42bd2f  dejagnu-1.5.3.tar.gz
660f4ac9340834a231d1516746d03d28  libpipeline-1.4.0.tar.gz
a2706a1413723b6b82eecb7d6982763c  eudev-3.0.tar.gz
dd7dab7a5fea97d2a6a43f511449b7cd  expat-2.1.0.tar.gz
cc825fa64bc7306a885f2fb2268d3ec5  groff-1.22.3.tar.gz
a1043102fbc7bcedbf53e7ee3d17ab91  grub-2.00.tar.xz
c70599ab0d037fde724f7210c2c8d7f8  sysklogd-1.5.1.tar.gz
b5e2dd95dc8498cea5354377ed89aa65  xz-5.2.1.tar.xz
57a7a224a822f94789a587ccbcedff69  make-4.1.tar.bz2
1fb7f3f6bf92ce6c5c9ed9949ae858fe  procps-ng-3.3.10.tar.xz
8b8c9d85469d8dbe32e51117b8ef11e3  tcl-core8.6.4-src.tar.gz
237083a1e3c388cde7a115a5724dc72a  iproute2-3.19.0.tar.xz
452ae548aa0421eee0bf2bfa21000e39  inetutils-1.9.3.tar.xz
997c9070354eff5517115feaea6038f0  gettext-0.19.4.tar.xz
abed135279f87ad6762ce57ff6d89c41  coreutils-8.23.tar.xz
8fb13e5259fe447e02c4a37bc7225add  file-5.22.tar.gz
1bfb9b923f2c1339b4d2ce1807064aa5  libtool-2.4.6.tar.xz
d6f4fef718a50bd88080de6a43bc64d8  kmod-20.tar.xz
d6a1d5f8ddea3abd2cc3e98f58352d26  mpc-1.0.3.tar.gz
43c48064d6409862b8a850db83c8038a  grep-2.21.tar.xz
38263d115d784c17aa3b959ce94be8b8  check-0.9.14.tar.gz
e3d203d188b8fe60bb6578dd3152e05c  mpfr-3.1.2.tar.xz
c2d6b127f89261513b23b6d458484099  udev-lfs-20140408.tar.bz2
21062666f1c627aeb6dbff3c6952738b  perl-5.20.2.tar.bz2
e3da7940431633fb65a01b91d3b7a27a  patch-2.7.5.tar.xz
ee4a480d77b341c99e8b1375f8f180c0  Linux-PAM-1.2.0.tar.bz2
bc759fc62666786f5436e2075beb3265  e2fsprogs-1.42.13.tar.gz
b595bdc4474b8fc1a15cffc67c66025b  tzdata2015d.tar.gz
2b958e9f5d200641e6fc9564977aecc5  nasm-2.11.06.tar.xz
4df8ee253b7f3863ad0b86359cd39c43  gcc-4.9.2.tar.bz2
9cb398828e8f84f57d1f7d5588cf40cd  glibc-2.21.tar.xz
9a5997c3452909b1769918c759eff8a2  glibc-2.21-fhs-1.patch
49b6306167724fe48f419a33a5beb857  tar-1.28.tar.xz
d43ab9f680435a7fff35b4ace8d45b80  libcap-2.24.tar.xz
ba56fb5bfd44acea83fc5dac4a9b7f15  kbd-2.0.2.tar.gz
f75cca16a38da6caa7d52151f7136895  kbd-2.0.2-backspace-1.patch
97f8f44149ea9b9e94be97f68988be87  gawk-4.1.3.tar.xz
1e6da4e434553d2811437aa42c7f7c76  gmp-6.0.0a.tar.xz
9bdf368c395f1b70325d0eb22c7f48fb  util-linux-2.26.2.tar.xz
2bfafe7d4962682d31b5eba65dba4fc8  shadow-4.2.1.tar.xz
d3fc8316d4d4d04b65cbc2d70799e763  linux-3.19.tar.xz
8e92e0a77b8311bb89000e8e672dbd63  patch-3.19.6.xz
88d32360e2ed18e05de9b528ad336fd8  man-db-2.7.1.tar.xz
c1f1db32fb6598d6a93e6e88796a8632  gperf-3.0.4.tar.gz
a06c547dac9044161a477211049f60ef  openssl-1.0.2a.tar.gz
efad5a503f66329bb9d2f4308b5de98a  libarchive-3.1.2.tar.gz
b6b0db5e3ee71ceba26d0a5accbd0666  xfsprogs-3.2.2.tar.gz
809eb8684bd9851242aa4dfbf1a49dd5  ca-certificates-20150530.tar.gz
296945012ce647b94083ed427c1877a8  curl-7.42.1.tar.bz2
d92ab59aabf5173f2a59089531e30dbf  squashfs4.3.tar.gz
f61577ec330ad1bd504c0e2eec6ea2d8  sudo-1.8.13.tar.gz
3c19adf32a8457983b71ff376ef7dafe  pciutils-3.3.0.tar.xz
cec96a54d92f0a297da4c1fb4cf0ac74  cards-1.0.2.tar.gz
326df8542d3a2376da907e98a0888ccf  LVM2.2.02.120.tgz
374fcac1877078a2fc0ef8cd1617a869  dhcpcd-6.9.0.tar.bz2
43bd6676f0b404326eee2d63be3cdcfe  rsync-3.1.1.tar.gz
1f178e2bb1beab9782993931c9832280  ports-1.5.tar.gz
34b07c50e6e3fc1ca18182e9f0fd5a67  libtirpc-0.3.0.tar.bz2
c8875246b2688a1adfbd6ad43480278d  rpcbind-0.2.3.tar.bz2
1e2f3c1ed468dee02d00c534c002ea10  nfs-utils-1.3.2.tar.bz2
08f72de6751acfbd0892b5f003922701  openssh-6.8p1.tar.gz
edb76ab11d78df7a5d5981807583acc2  btrfs-progs-v3.19.tar.xz
0b8dc818ed4766342978d744522aec49  git-2.4.2.tar.xz
c7ffc9a103afe2d1bba0b015e7aa887f  lzo-2.09.tar.gz
8809465cd48a202895bc2a12e1923b5d  jfsutils-1.1.15.tar.gz
44698d351501cac6a89072dc877eb220  mdadm-3.3.2.tar.xz
d2e4455781a70140ae83b54ca594ce21  wget-1.16.3.tar.xz" > $LFS/sources/md5sums

for i in `cat scripts/wget_nutyx_list`
do 
	if [ ! -f $LFS/sources/`basename $i` ]; then 
		wget --no-check-certificate $i -P $LFS/sources
	fi
done
if [ -f $LFS/sources/md5sums ]; then
	pushd  $LFS/sources
	md5sum -c md5sums || exit 1
	popd
else
	echo "$LFS/sources/md5sums pas trouvé, impossible de vérifier les sources"
	exit 1
fi
echo ""
echo "====> Successfull configured"
echo ""
echo "Si vous lisez ce message, faites:"
echo ""
echo "cd $HOME/saravane/chroot"
echo "pass"
echo ""
echo "Admirez le travail ..."
echo "" 
